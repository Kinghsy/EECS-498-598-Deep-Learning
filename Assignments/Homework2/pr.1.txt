C:\Users\shuya\AppData\Local\Programs\Python\Python36\python.exe D:/test/transfer_learning.py
Finetune the pre-trained model
Performance of pre-trained model without finetuning
Training complete in 0m 4s
Best val Acc: 0.692810
Finetune the model
Epoch 0/24
----------
train Loss: 0.7278 Acc: 0.6639
val Loss: 0.4004 Acc: 0.8431
Epoch 1/24
----------
train Loss: 0.4132 Acc: 0.8402
val Loss: 0.2916 Acc: 0.8889
Epoch 2/24
----------
train Loss: 0.6270 Acc: 0.7500
val Loss: 0.2743 Acc: 0.8824
Epoch 3/24
----------
train Loss: 0.4907 Acc: 0.8033
val Loss: 0.3854 Acc: 0.8431
Epoch 4/24
----------
train Loss: 0.5118 Acc: 0.7664
val Loss: 0.2962 Acc: 0.8954
Epoch 5/24
----------
train Loss: 0.4842 Acc: 0.8033
val Loss: 0.2492 Acc: 0.9085
Epoch 6/24
----------
train Loss: 0.3414 Acc: 0.8402
val Loss: 0.3900 Acc: 0.8824
Epoch 7/24
----------
train Loss: 0.4265 Acc: 0.8525
val Loss: 0.2343 Acc: 0.9281
Epoch 8/24
----------
train Loss: 0.2409 Acc: 0.9016
val Loss: 0.2352 Acc: 0.9346
Epoch 9/24
----------
train Loss: 0.2546 Acc: 0.9139
val Loss: 0.2075 Acc: 0.9281
Epoch 10/24
----------
train Loss: 0.3745 Acc: 0.8443
val Loss: 0.1999 Acc: 0.9281
Epoch 11/24
----------
train Loss: 0.2439 Acc: 0.9057
val Loss: 0.1801 Acc: 0.9346
Epoch 12/24
----------
train Loss: 0.2394 Acc: 0.8893
val Loss: 0.2094 Acc: 0.9346
Epoch 13/24
----------
train Loss: 0.2146 Acc: 0.9098
val Loss: 0.2177 Acc: 0.9216
Epoch 14/24
----------
train Loss: 0.2340 Acc: 0.9098
val Loss: 0.1903 Acc: 0.9281
Epoch 15/24
----------
train Loss: 0.2667 Acc: 0.8770
val Loss: 0.1990 Acc: 0.9216
Epoch 16/24
----------
train Loss: 0.2108 Acc: 0.9262
val Loss: 0.2005 Acc: 0.9150
Epoch 17/24
----------
train Loss: 0.3462 Acc: 0.8648
val Loss: 0.2291 Acc: 0.9346
Epoch 18/24
----------
train Loss: 0.3013 Acc: 0.8689
val Loss: 0.2037 Acc: 0.9281
Epoch 19/24
----------
train Loss: 0.2440 Acc: 0.8975
val Loss: 0.1853 Acc: 0.9150
Epoch 20/24
----------
train Loss: 0.3038 Acc: 0.8811
val Loss: 0.1990 Acc: 0.9281
Epoch 21/24
----------
train Loss: 0.3407 Acc: 0.8648
val Loss: 0.1851 Acc: 0.9216
Epoch 22/24
----------
train Loss: 0.3029 Acc: 0.8607
val Loss: 0.2142 Acc: 0.9281
Epoch 23/24
----------
train Loss: 0.2656 Acc: 0.8811
val Loss: 0.2085 Acc: 0.9281
Epoch 24/24
----------
train Loss: 0.2692 Acc: 0.8852
val Loss: 0.2116 Acc: 0.9346
Training complete in 2m 57s
Best val Acc: 0.934641
Freeze the parameters in pre-trained model and train the final fc layer
Performance of pre-trained model without finetuning
Training complete in 0m 3s
Best val Acc: 0.607843
Finetune the model
Epoch 0/24
----------
train Loss: 0.5131 Acc: 0.7336
val Loss: 0.2405 Acc: 0.9281
Epoch 1/24
----------
train Loss: 0.4564 Acc: 0.8033
val Loss: 0.2451 Acc: 0.9150
Epoch 2/24
----------
train Loss: 0.6942 Acc: 0.7049
val Loss: 0.2207 Acc: 0.9346
Epoch 3/24
----------
train Loss: 0.4508 Acc: 0.7910
val Loss: 0.4995 Acc: 0.8105
Epoch 4/24
----------
train Loss: 0.4109 Acc: 0.8279
val Loss: 0.1718 Acc: 0.9542
Epoch 5/24
----------
train Loss: 0.4948 Acc: 0.7746
val Loss: 0.1698 Acc: 0.9608
Epoch 6/24
----------
train Loss: 0.7285 Acc: 0.7377
val Loss: 0.6481 Acc: 0.7843
Epoch 7/24
----------
train Loss: 0.4796 Acc: 0.8115
val Loss: 0.2012 Acc: 0.9477
Epoch 8/24
----------
train Loss: 0.3288 Acc: 0.8689
val Loss: 0.1871 Acc: 0.9542
Epoch 9/24
----------
train Loss: 0.2922 Acc: 0.8770
val Loss: 0.1848 Acc: 0.9477
Epoch 10/24
----------
train Loss: 0.3367 Acc: 0.8361
val Loss: 0.2082 Acc: 0.9477
Epoch 11/24
----------
train Loss: 0.3088 Acc: 0.8770
val Loss: 0.2031 Acc: 0.9412
Epoch 12/24
----------
train Loss: 0.3246 Acc: 0.8443
val Loss: 0.1965 Acc: 0.9477
Epoch 13/24
----------
train Loss: 0.3607 Acc: 0.8402
val Loss: 0.2869 Acc: 0.9020
Epoch 14/24
----------
train Loss: 0.3934 Acc: 0.8443
val Loss: 0.2197 Acc: 0.9346
Epoch 15/24
----------
train Loss: 0.3070 Acc: 0.8811
val Loss: 0.2005 Acc: 0.9477
Epoch 16/24
----------
train Loss: 0.2595 Acc: 0.8893
val Loss: 0.1815 Acc: 0.9542
Epoch 17/24
----------
train Loss: 0.3240 Acc: 0.8402
val Loss: 0.2005 Acc: 0.9477
Epoch 18/24
----------
train Loss: 0.4300 Acc: 0.7992
val Loss: 0.1714 Acc: 0.9542
Epoch 19/24
----------
train Loss: 0.3958 Acc: 0.8279
val Loss: 0.1983 Acc: 0.9412
Epoch 20/24
----------
train Loss: 0.2083 Acc: 0.9139
val Loss: 0.2632 Acc: 0.9085
Epoch 21/24
----------
train Loss: 0.3925 Acc: 0.8156
val Loss: 0.2157 Acc: 0.9412
Epoch 22/24
----------
train Loss: 0.2971 Acc: 0.8852
val Loss: 0.1951 Acc: 0.9412
Epoch 23/24
----------
train Loss: 0.2605 Acc: 0.8893
val Loss: 0.1998 Acc: 0.9477
Epoch 24/24
----------
train Loss: 0.3293 Acc: 0.8484
val Loss: 0.1973 Acc: 0.9412
Training complete in 2m 24s
Best val Acc: 0.960784

Process finished with exit code 0
